<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vooters Break - Admin</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const firebaseConfig = {
            apiKey: "AIzaSyBe3ftCo_LjKuKJinDWwYEH39lM8-RrN7I",
            authDomain: "vooter-s-break-1cc7f.firebaseapp.com",
            databaseURL: "https://vooter-s-break-1cc7f-default-rtdb.firebaseio.com",
            projectId: "vooter-s-break-1cc7f",
            storageBucket: "vooter-s-break-1cc7f.firebasestorage.app",
            messagingSenderId: "110233483951",
            appId: "1:110233483951:web:87372560112c986c1b725a"
        };

        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const database = firebase.database();

        const ADMIN_PASSWORD = 'vooters2024';

        function VootersBreakAdmin() {
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [password, setPassword] = useState('');
            const [breaks, setBreaks] = useState([]);
            const [pendingReservations, setPendingReservations] = useState([]);
            const [activeTab, setActiveTab] = useState('breaks');
            const [showAddBreak, setShowAddBreak] = useState(false);
            
            const [newBreak, setNewBreak] = useState({
                title: '',
                sport: 'hockey',
                product: '',
                boxCount: 1,
                pricePerSpot: '',
                totalSpots: 32,
                date: '',
                time: '',
                status: 'upcoming',
                description: ''
            });

            useEffect(() => {
                if (isAuthenticated) {
                    const breaksRef = database.ref('breaks');
                    const reservationsRef = database.ref('reservations');
                    
                    breaksRef.on('value', (snapshot) => {
                        const data = snapshot.val();
                        if (data) {
                            const breaksArray = Object.keys(data).map(key => ({
                                ...data[key],
                                id: key
                            }));
                            setBreaks(breaksArray);
                        }
                    });

                    reservationsRef.on('value', (snapshot) => {
                        const data = snapshot.val();
                        if (data) {
                            const reservationsArray = Object.keys(data).map(key => ({
                                ...data[key],
                                id: key
                            })).filter(r => r.status === 'pending');
                            setPendingReservations(reservationsArray);
                        }
                    });

                    return () => {
                        breaksRef.off();
                        reservationsRef.off();
                    };
                }
            }, [isAuthenticated]);

            const handleLogin = () => {
                if (password === ADMIN_PASSWORD) {
                    setIsAuthenticated(true);
                    setPassword('');
                } else {
                    alert('Mot de passe incorrect');
                }
            };

            const addBreak = () => {
                if (!newBreak.title || !newBreak.product || !newBreak.pricePerSpot) {
                    alert('Veuillez remplir tous les champs requis');
                    return;
                }

                const breakToAdd = {
                    ...newBreak,
                    createdAt: new Date().toISOString(),
                    teams: [],
                    participants: {},
                    randomizedTeams: []
                };

                database.ref('breaks').push(breakToAdd).then(() => {
                    setNewBreak({
                        title: '',
                        sport: 'hockey',
                        product: '',
                        boxCount: 1,
                        pricePerSpot: '',
                        totalSpots: 32,
                        date: '',
                        time: '',
                        status: 'upcoming',
                        description: ''
                    });
                    setShowAddBreak(false);
                    alert('Break crÃ©Ã© avec succÃ¨s!');
                });
            };

            const deleteBreak = (id) => {
                if (window.confirm('Voulez-vous vraiment supprimer ce break?')) {
                    database.ref('breaks/' + id).remove();
                }
            };

            const updateBreakStatus = (id, newStatus) => {
                database.ref('breaks/' + id).update({ status: newStatus });
            };

            const generateAIDescription = (sport, product) => {
                const descriptions = {
                    hockey: [
                        `Break de ${product}! Excellentes chances de hits avec des rookies et autographes possibles!`,
                        `ðŸ”¥ Break HOT! ${product} - Recherchez vos joueurs prÃ©fÃ©rÃ©s et les cartes parallÃ¨les rares!`
                    ],
                    baseball: [
                        `âš¾ Break MLB! ${product} - Chassez les rookies et autographes!`
                    ],
                    basketball: [
                        `ðŸ€ Break NBA! ${product} - Rookies stars et cartes numÃ©rotÃ©es!`
                    ],
                    football: [
                        `ðŸˆ Break NFL! ${product} - Rookies et autographes!`
                    ]
                };

                const sportDescriptions = descriptions[sport] || descriptions.hockey;
                return sportDescriptions[Math.floor(Math.random() * sportDescriptions.length)];
            };

            const addAIDescription = (breakId, breakItem) => {
                const aiDescription = generateAIDescription(br
